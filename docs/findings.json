{
  "auditoria": {
    "data": "2025-08-25",
    "arquiteto": "Claude 4 Sonnet",
    "projeto": "B3DataManager",
    "versao_spring_boot": "3.5.5",
    "versao_java": "21"
  },
  "achados": [
    {
      "id": "SEC-001",
      "categoria": "Seguranca",
      "severidade": "CRITICA",
      "titulo": "Secrets em Plain-Text",
      "arquivo": "src/main/resources/application.properties",
      "linhas": [6, 35],
      "evidencia": "spring.datasource.password=nB132MUlpZ4jxn7f\napi.alpha.key=BRRQ6MQO8CYYPM5M",
      "impacto": "Vazamento de credenciais, comprometimento de sistemas externos",
      "recomendacao": "Migrar para variaveis de ambiente ou Spring Cloud Config",
      "cve_relacionadas": [],
      "esforco_estimado": "2 horas"
    },
    {
      "id": "SEC-002",
      "categoria": "Seguranca",
      "severidade": "CRITICA",
      "titulo": "Frame Options Desabilitado",
      "arquivo": "src/main/java/br/dev/rodrigopinheiro/B3DataManager/presentation/security/SecurityConfig.java",
      "linhas": [44],
      "evidencia": "configurer.frameOptions(HeadersConfigurer.FrameOptionsConfig::disable)",
      "impacto": "Vulnerabilidade a ataques de clickjacking",
      "recomendacao": "Remover ou configurar SAMEORIGIN",
      "cve_relacionadas": ["CWE-1021"],
      "esforco_estimado": "30 minutos"
    },
    {
      "id": "OBS-001",
      "categoria": "Observabilidade",
      "severidade": "CRITICA",
      "titulo": "Ausencia de Actuator",
      "arquivo": "src/main/resources/application.properties",
      "linhas": ["ausente"],
      "evidencia": "Nenhuma configuracao de management.endpoints encontrada",
      "impacto": "Impossibilidade de monitoramento em producao",
      "recomendacao": "Habilitar Actuator com endpoints essenciais (health, metrics, info)",
      "cve_relacionadas": [],
      "esforco_estimado": "4 horas"
    },
    {
      "id": "DATA-001",
      "categoria": "Dados",
      "severidade": "CRITICA",
      "titulo": "Ausencia de Flyway/Migracoes",
      "arquivo": "pom.xml",
      "linhas": ["ausente"],
      "evidencia": "Nenhuma dependencia de migracao de schema encontrada",
      "impacto": "Inconsistencias de schema entre ambientes",
      "recomendacao": "Implementar Flyway com baseline atual",
      "cve_relacionadas": [],
      "esforco_estimado": "8 horas"
    },
    {
      "id": "PERF-001",
      "categoria": "Performance",
      "severidade": "ALTA",
      "titulo": "Eager Loading em Relacionamentos",
      "arquivo": "src/main/java/br/dev/rodrigopinheiro/B3DataManager/domain/entity/Usuario.java",
      "linhas": [40],
      "evidencia": "@ElementCollection(fetch = FetchType.EAGER)",
      "impacto": "Performance degradada, possivel N+1 queries",
      "recomendacao": "Migrar para LAZY e usar JOIN FETCH quando necessario",
      "cve_relacionadas": [],
      "esforco_estimado": "3 horas"
    },
    {
      "id": "PERF-002",
      "categoria": "Performance",
      "severidade": "ALTA",
      "titulo": "Open-in-View Habilitado",
      "arquivo": "src/main/resources/application.properties",
      "linhas": ["default"],
      "evidencia": "spring.jpa.open-in-view is enabled by default",
      "impacto": "Queries durante renderizacao da view, conexoes longas",
      "recomendacao": "Desabilitar e implementar DTOs adequados",
      "cve_relacionadas": [],
      "esforco_estimado": "6 horas"
    },
    {
      "id": "SEC-003",
      "categoria": "Seguranca",
      "severidade": "ALTA",
      "titulo": "Ausencia de Rate Limiting",
      "arquivo": "src/main/java/br/dev/rodrigopinheiro/B3DataManager/presentation/security/SecurityConfig.java",
      "linhas": ["ausente"],
      "evidencia": "Nenhuma configuracao de throttling encontrada",
      "impacto": "Vulnerabilidade a ataques de forca bruta e DoS",
      "recomendacao": "Implementar rate limiting com Resilience4j",
      "cve_relacionadas": ["CWE-307"],
      "esforco_estimado": "4 horas"
    },
    {
      "id": "DEP-001",
      "categoria": "Dependencias",
      "severidade": "ALTA",
      "titulo": "Dependencias Desatualizadas",
      "arquivo": "pom.xml",
      "linhas": [104, 109],
      "evidencia": "poi:5.3.0 (atual: 5.3.1), mockito-inline:5.2.0 (atual: 5.17.0)",
      "impacto": "Possiveis vulnerabilidades de seguranca conhecidas",
      "recomendacao": "Atualizar para versoes mais recentes",
      "cve_relacionadas": [],
      "esforco_estimado": "2 horas"
    },
    {
      "id": "VAL-001",
      "categoria": "Validacao",
      "severidade": "MEDIA",
      "titulo": "Ausencia de Validacao em Endpoints",
      "arquivo": "src/main/java/br/dev/rodrigopinheiro/B3DataManager/presentation/view/",
      "linhas": ["multiplas"],
      "evidencia": "Nenhuma anotacao @Valid encontrada em parametros",
      "impacto": "Dados invalidos podem ser processados",
      "recomendacao": "Implementar validacao com Bean Validation",
      "cve_relacionadas": ["CWE-20"],
      "esforco_estimado": "6 horas"
    },
    {
      "id": "LOG-001",
      "categoria": "Logs",
      "severidade": "MEDIA",
      "titulo": "Logs Excessivos em Producao",
      "arquivo": "src/main/resources/application.properties",
      "linhas": [28, 29],
      "evidencia": "logging.level.br.dev.rodrigopinheiro=DEBUG",
      "impacto": "Performance degradada, logs verbosos em producao",
      "recomendacao": "Configurar profiles especificos para producao",
      "cve_relacionadas": [],
      "esforco_estimado": "1 hora"
    }
  ],
  "metricas": {
    "total_achados": 10,
    "criticos": 4,
    "altos": 4,
    "medios": 2,
    "baixos": 0,
    "esforco_total_estimado": "36.5 horas",
    "prioridade_maxima": "Implementar observabilidade e externalizar secrets"
  }
}